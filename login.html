<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login - Book My Events</title>
  <link rel="shortcut icon" href="./logo/favicon.ico" type="image/x-icon">


  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body,
    html {
      height: 100%;
      margin: 0;
      font-family: "Poppins", sans-serif;
    }

    a {
      color: #f32626;
    }

    .bg-right {
      background-image: url('https://images.pexels.com/photos/169190/pexels-photo-169190.jpeg?_gl=1*1trrv6r*_ga*OTQzMjkzNjEzLjE3NjE5OTQzMTY.*_ga_8JE65Q40S6*czE3NjM5OTczNTUkbzMkZzEkdDE3NjM5OTczNjgkajQ3JGwwJGgw');
      background-size: cover;
      background-position: center;
      min-height: 100vh;
    }

    .img-fluid {
      width: 270px;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }

    .login-wrapper {
      justify-content: center;
      align-items: center;
      display: flex;
      flex-direction: column;
      width: 100%;
    }

    .login-form {
      max-width: 500px;
      margin-top: 30px;
      width: 100%;
    }

    .form-control {
      border-radius: 0;
      border: none;
      border-bottom: 1px solid #ccc;
      height: 48px;
    }

    .form-control:focus {
      box-shadow: none;
      border-bottom-color: #f7371d;
    }

    .btn-login {
      background: #f32626;
      border: none;
      height: 48px;
      width: 100%;
      font-size: 18px;
      font-weight: 600;
      border-radius: 5px;
      color: #fff;
    }

    .password-wrapper {
      position: relative;
    }

    .toggle-eye {
      position: absolute;
      right: 10px;
      top: 12px;
      cursor: pointer;
      font-size: 20px;
      color: #888;
    }
  </style>

</head>

<body>

  <div class="container-fluid">
    <div class="row">
      <!-- RIGHT IMAGE -->
      <div class="col-md-6 bg-right d-none d-md-block"></div>
      <!-- LEFT FORM -->
      <div class="col-md-6 d-flex align-items-center">
        <div class="login-wrapper">

          <a href="./index.html">
            <img class="img-fluid" src="assets/img/footer-logo.svg" alt="Book my event">
          </a>

          <div id="loginMsg"></div>

          <form class="login-form needs-validation" id="loginForm" novalidate>

            <label class="mb-1">Username</label>
            <input type="text" class="form-control mb-4" id="loginEmail" placeholder="email@example.com" required>
            <div class="invalid-feedback">Please enter your email or username.</div>

            <label class="mb-1">Password</label>
            <div class="password-wrapper mb-4">
              <input type="password" class="form-control" id="loginPassword" placeholder="enter your password" required>
              <i class="bi bi-eye toggle-eye" onclick="togglePassword('loginPassword', this)"></i>
              <div class="invalid-feedback">Password is required.</div>
            </div>

            <button class="btn-login mb-3" type="submit">Login</button>

            <a href="#" class="d-block mb-4 text-decoration-none">Forgot password?</a>

            <p>Don't have an account? <a class="text-decoration-none" href="register.html">Register here</a></p>

          </form>

        </div>
      </div>



    </div>
  </div>

  <script>
    // SHOW / HIDE PASSWORD
    function togglePassword(id, icon) {
      const field = document.getElementById(id);
      const isPassword = field.type === "password";
      field.type = isPassword ? "text" : "password";
      icon.classList.toggle("bi-eye");
      icon.classList.toggle("bi-eye-slash");
    }

    // BOOTSTRAP VALIDATION SCRIPT
    (() => {
      const forms = document.querySelectorAll('.needs-validation');
      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    })();

    // LOGIN API
    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      if (!e.target.checkValidity()) {
        return;
      }

      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;
      const loginMsg = document.getElementById("loginMsg");

      loginMsg.innerHTML = `<div class='alert alert-info'>Checking...</div>`;

      try {
        const res = await fetch("https://api.bookmyevent.ae/api/auth/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        });

        const data = await res.json();

        if (res.ok) {
          loginMsg.innerHTML = `<div class='alert alert-success'>Login Successful!</div>`;
        } else {
          loginMsg.innerHTML = `<div class='alert alert-danger'>${data.message}</div>`;
        }
      } catch {
        loginMsg.innerHTML = `<div class='alert alert-danger'>Something went wrong!</div>`;
      }
    });
  </script>

</body>

</html>